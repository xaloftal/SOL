<!DOCTYPE html>
<html lang="en">
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta charset="utf-8">
  <meta name="description" content="">
  <title>Contas- Saúde On-Line</title>
  <link id="u-theme-google-font" rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:100,100i,300,300i,400,400i,500,500i,700,700i,900,900i|Open+Sans:300,300i,400,400i,500,500i,600,600i,700,700i,800,800i">
  <link id="u-page-google-font" rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:300,300i,400,400i,500,500i,700,700i">
  <link rel="stylesheet" href="CSS/style.css" media="screen">
  <link rel="stylesheet" href="CSS/styleSections.css" media="screen">
  <link rel="stylesheet" href="CSS/adm_modal.css" media="screen">
  <link rel="stylesheet" href="CSS/footer.css" media="screen">
  <link rel="stylesheet" href="CSS/bootstrap.min.css" media="screen">
  <link rel="stylesheet" href="CSS/header.css" media="screen">
  <link rel="stylesheet" href="CSS/paginaPrincipalAdm.css" media="screen">
  <link rel="stylesheet" href="CSS/accordion.css" media="screen">
  <script class="u-script" type="text/javascript" src="JavaScript/jquery.js" defer=""></script>
  <script class="u-script" type="text/javascript" src="JavaScript/style.js" defer=""></script>
  <script class="u-script" type="text/javascript" src="JavaScript/modal.js" defer=""></script>
  <script class="u-script" type="text/javascript" src="JavaScript/accordion.js" defer=""></script>
  <script class="u-script" type="text/javascript" src="JavaScript/consulta.js" defer=""></script>
  <script class="u-script" type="text/javascript" src="JavaScript/notification.js" defer=""></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
  <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
  
  <script type="application/ld+json">
    
    {
      "@context": "http://schema.org",
      "@type": "Organization",
      "name": ""
    }

  </script>

  <script type="text/javascript">
      

    window.onload = () => {
        $.ajax({
            url: "http://localhost:3050/GetContasMedico",
            type: "GET",
            crossDomain: false,
            dataType: "json",
            headers: {
                "accept": "application/json",
                "Access-Control-Allow-Origin":"*"
            },
            'Access-Control-Allow-OSrigin': '*'
        })
        .then((response) => {
          let containerMedico = document.querySelector('[data-id="contaMedicoContainer"]');
          response.forEach(contaMedico => {
            console.log(contaMedico);
            containerMedico.innerHTML += '<div class="account-card"><div class="consultation-info"><span><strong class="account-info-1">Nome: </strong>' + contaMedico.nome_m + '</span><span><strong class="account-info-2">Especialidade: </strong>' + contaMedico.nome_esp + '</span><span><strong class="account-info-3">Email: </strong>' + contaMedico.email + '</span></div><div class="line"></div><div class="consultation-booking"><button class="myBtn action-btn remove-btn btn-text remove-btn-2" onclick="deleteAccount(\'' + contaMedico.email + '\')">Eliminar</button></div></div></div>';
          })

          updateModalBtns();
        })
        .catch((error) => {
            console.error(error)
        });

        $.ajax({
            url: "http://localhost:3050/GetContasUtente",
            type: "GET",
            crossDomain: false,
            dataType: "json",
            headers: {
                "accept": "application/json",
                "Access-Control-Allow-Origin":"*"
            },
            'Access-Control-Allow-OSrigin': '*'
        })
        .then((response) => {
          let containerUtente = document.querySelector('[data-id="contaUtenteContainer"]');
          response.forEach(contaUtente => {
            console.log(contaUtente);
            containerUtente.innerHTML += '<div class="account-card"><div class="consultation-info"><span><strong class="account-info-4">Nome: </strong>' + contaUtente.nome_u + '</span><span><strong class="account-info-5">Email: </strong>' + contaUtente.email + '</span></div><a style="color:#4D77FF" class="more-details" id="accordionBtn1" onclick="toggleAccordion(\'accordionContent1\', \'accordionBtn1\')"><u>Mais detalhes</u></a><div class="accordion-content" id="accordionContent1"><span><strong class="account-info-1">Data de nascimento: </strong>' + contaUtente.dat_nasc + '</span><span><strong class="account-info-2">NIF: </strong>' + contaUtente.nif_u + '</span><span><strong class="account-info-3">Telefone: </strong>' + contaUtente.tele_u + '</span></div><div class="consultation-booking"><div class="line"></div><button class="action-btn remove-btn btn-text remove-btn-2" onclick="deleteAccount(\'' + contaUtente.email_u + '\')">Eliminar</button></div></div>';
          })
        })
        .catch((error) => {
            console.error(error)
        });
      }
      
      deleteAccount = (email) => {

          $.ajax({
              url: "http://localhost:3050/EliminarConta?email=" + email,
              type: "PUT",
              crossDomain: false,
              dataType: "json",
              headers: { 
                  "accept": "application/json",
                  "Access-Control-Allow-Origin":"*"
              },
              'Access-Control-Allow-OSrigin': '*'
          })
          .then((response) => {
              alert('Conta eliminada com sucesso.')
          })
          .catch((error) => {
              alert('Eliminação sem sucesso')
          });

      }
     
      // Define the toggleAccordion function in the global scope
      function toggleAccordion(contentId, btnId) {
          var content = document.getElementById(contentId);
          var btn = document.getElementById(btnId);

          // Toggle the accordion content
          content.classList.toggle("show");
      }
  </script>

</head>

<body class="u-body u-xl-mode" data-lang="en">
    <!--Cabeçalho-->
  <header>
    <div class="header-div">
      <div class="header-div-all-content">
        <div class="header-div-logo">
          <div>
            <img  class="img-logo" src="imagens/logotipo.png"></img>
            <span class="saude-span">Saúde </span>
            <span class="online-span">On-Line</span>
          </div>
        </div>
        <div class="header-div-content-select">
          <div><a href="PaginaPrincipalAdm.html" class="a-content-letter">Consultas</a></div>
          <div><a href="PaginaPrincipalAdm.html" class="a-content-letter">Reclamações</a></div>
          <div><a href="" class="a-content-letter">Contas</a></div>
          <div><a href="#rodape" class="a-content-letter">Contactos</a></div>
        </div>
        <div class="header-button-div">
          <div class="header-button-div-two">
            <div class="header-button-content">Terminar sessão</div>
          </div>
        </div>
      </div>
      <div class="header-line"></div>
    </div>
  </header>

  <!--Consultas-->

  <section class="section-1" id="section-1">
    <div class="title-section">
        <p>Médicos</p>
    </div>

    <div data-id="contaMedicoContainer">
    </div>

    <div class="title-section">
        <p>Utentes</p>
    </div>

    <div data-id="contaUtenteContainer">
    </div>

  </section>

   <!--Rodapé-->

  <div class="footer" id="rodape">
    <p class="footer-intro">A conectar utentes e médicos para cuidados de saúde personalizados desde 2020.</p>
    <p>Rua Afonso Albuquerque, Nº 9 · Barcelos · Braga</p>
    <div class="footer-phone-info-div">
      <img src="imagens/icons8-phone-50 1.png" />
      <div class="footer-info-letter">+351 253 467 451</div>
    </div>
    <div class="footer-email-info-div">
      <img src="imagens/icons8-email-50 1.png"/>
      <div class="footer-info-letter">info@saudeonline.pt</div>
    </div>
    <div class="footer-logo">
      <img style="width: 40px"src="imagens/logotipo.png"/>
      <span>Saúde </span>
      <span class="footer-online">On-Line</span>
    </div>
  </div>
  <div class="footer-copyright-div">
    <div class="footer-copyright-letter">© 2023 Saúde On-Line </div>
  </div> 

</body>
</html>